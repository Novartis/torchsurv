
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Time-Varying Covariates &#8212; TorchSurv 0.1.5 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=0cc05dfd" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=98feffa1"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/time_varying_covariates';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Changelog" href="../CHANGELOG.html" />
    <link rel="prev" title="Metrics" href="metrics.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>
<aside class="bd-header-announcement" aria-label="Announcement">
  <div class="bd-header-announcement__content">ðŸŽ‰ We are part of the <a href='https://cdrh-rst.fda.gov/torchsurv-deep-learning-tools-survival-analysis'> FDA's Regulatory Science Tools Catalog!</a> ðŸŽ‰</div>
</aside>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo_firecamp.png" class="logo__image only-light" alt="TorchSurv 0.1.5 documentation - Home"/>
    <img src="../_static/logo_firecamp.png" class="logo__image only-dark pst-js-only" alt="TorchSurv 0.1.5 documentation - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">API:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../loss.html">Loss</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/torchsurv.loss.cox.html">torchsurv.loss.cox</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/torchsurv.loss.weibull.html">torchsurv.loss.weibull</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/torchsurv.loss.survival.html">torchsurv.loss.survival</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/torchsurv.loss.momentum.html">torchsurv.loss.momentum</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../metrics.html">Metrics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/torchsurv.metrics.auc.html">torchsurv.metrics.auc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/torchsurv.metrics.cindex.html">torchsurv.metrics.cindex</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/torchsurv.metrics.brier_score.html">torchsurv.metrics.brier_score</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../stats.html">Stats</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/torchsurv.stats.kaplan_meier.html">torchsurv.stats.kaplan_meier</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_autosummary/torchsurv.stats.ipcw.html">torchsurv.stats.ipcw</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Survival Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="momentum.html">Survival Regression with MNIST</a></li>

<li class="toctree-l1"><a class="reference internal" href="regression_time_varying.html">Survival Regression with Time-Varying Covariates</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Under the hood:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="loss.html">Loss</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">Metrics</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Time-Varying Covariates</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Other:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOG.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CODEOWNERS-copy.html">Maintainers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING-copy.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CODE_OF_CONDUCT-copy.html">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devnotes.html">Development notes</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/Novartis/torchsurv" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/time_varying_covariates.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Time-Varying Covariates</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extended-cox-model">1. Extended Cox Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#flexible-survival-model">2. Flexible Survival Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#faq">FAQ</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-are-time-varying-covariates">What are time-varying covariates?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#can-the-cox-model-handle-time-varying-covariates">Can the Cox model handle time-varying covariates?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-type-of-neural-networks-nns-can-be-used-with-the-cox-model-for-time-varying-covariates">What type of neural networks (NNs) can be used with the Cox model for time-varying covariates?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-the-difference-between-the-cox-model-and-the-flexible-survival-model">What is the difference between the Cox model and the flexible survival model?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#when-should-i-use-the-flexible-survival-model-instead-of-the-cox-model">When should I use the flexible survival model instead of the Cox model?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#can-i-use-time-varying-covariates-with-weibull-or-exponential-model">Can I use time-varying covariates with Weibull or Exponential model?</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="time-varying-covariates">
<h1>Time-Varying Covariates<a class="headerlink" href="#time-varying-covariates" title="Link to this heading">#</a></h1>
<h1> Survival Models with Time-Varying Covariates</h2>
<ul class="simple">
<li><p><strong>Author</strong>: MÃ©lodie Monod</p></li>
</ul>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>In this document, we describe the mathematical formulation and assumptions behind the survival modelsâ€™ loss implemented in the <code class="docutils literal notranslate"><span class="pre">loss</span></code> module of <code class="docutils literal notranslate"><span class="pre">TorchSurv</span></code>, which can accommodate time-varying covariates.</p>
<p>Let individual <span class="math notranslate nohighlight">\(i\)</span> have a time-to-event <span class="math notranslate nohighlight">\(X_i\)</span> and a censoring time <span class="math notranslate nohighlight">\(D_i\)</span>. We observe</p>
<div class="math notranslate nohighlight">
\[
T_i = \min(X_i, D_i)
\]</div>
<p>along with the event indicator</p>
<div class="math notranslate nohighlight">
\[
\delta_i = \mathbb{1}(X_i \le D_i),
\]</div>
<p>where <span class="math notranslate nohighlight">\(\delta_i = 1\)</span> if the event is observed and <span class="math notranslate nohighlight">\(\delta_i = 0\)</span> if the data is censored.
Each individual also has covariates <span class="math notranslate nohighlight">\(\mathbf{x}_i(t)\)</span> at multiple time points <span class="math notranslate nohighlight">\(t\)</span>, which may be high-dimensional.</p>
</section>
<section id="extended-cox-model">
<h2>1. Extended Cox Model<a class="headerlink" href="#extended-cox-model" title="Link to this heading">#</a></h2>
<p>The Extended Cox model loss is available through the function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">torchsurv.loss.cox</span><span class="w"> </span><span class="kn">import</span> <span class="n">neg_partial_log_likelihood</span>
</pre></div>
</div>
<p>The implementation only differs from the standard Cox model in that the <code class="docutils literal notranslate"><span class="pre">log_hz</span></code> argument must be two-dimensional, with rows corresponding to subjects and columns corresponding to the time points of each subject.</p>
<p><strong>Hazard function.</strong>
The standard Cox proportional hazards model assumes a hazard function of the form:</p>
<div class="math notranslate nohighlight">
\[
h_i(t) = \lambda_0(t) \, \lambda_i(t), \quad \text{with} \quad \lambda_i(t) = \exp(\mathbf{x}_i(t)^\top \beta),
\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda_0(t)\)</span> is the baseline hazard and <span class="math notranslate nohighlight">\(\lambda_i(t)\)</span> is the relative hazard at time <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p><strong>PyTorch NN output.</strong>
In <code class="docutils literal notranslate"><span class="pre">TorchSurv</span></code>, the user may specify the relative hazard with a PyTorch neural network:</p>
<div class="math notranslate nohighlight">
\[
\log \lambda_i(t) = f_\theta(\mathbf{x}_i(t)).
\]</div>
<p><strong>Loss function.</strong> The loss function is defined as the negative partial log-likelihood:</p>
<div class="math notranslate nohighlight">
\[
\text{npll} = - \sum_{i: \delta_i = 1} \left( \log \lambda_i(T_i) - \log \sum_{j \in R(T_i)} \lambda_j(T_i) \right),
\]</div>
<p>where <span class="math notranslate nohighlight">\(R(T_i)\)</span> is the risk set at time <span class="math notranslate nohighlight">\(T_i\)</span>.</p>
<p><strong>Assumptions.</strong></p>
<ul class="simple">
<li><p>The function <span class="math notranslate nohighlight">\(f_\theta\)</span> does not depend on time.</p></li>
<li><p>Proportional hazards: the relative hazard does not vary with time conditional on the covariates.</p></li>
<li><p>Independence between censoring and event times.</p></li>
<li><p>Correct specification of the covariate effect (linear in standard Cox, flexible in <code class="docutils literal notranslate"><span class="pre">TorchSurv</span></code> neural network).</p></li>
</ul>
</section>
<section id="flexible-survival-model">
<h2>2. Flexible Survival Model<a class="headerlink" href="#flexible-survival-model" title="Link to this heading">#</a></h2>
<p>The Flexible Survival model loss is available through the function</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">torchsurv.loss.survival</span><span class="w"> </span><span class="kn">import</span> <span class="n">neg_log_likelihood</span>
</pre></div>
</div>
<p>The argument <code class="docutils literal notranslate"><span class="pre">log_hz</span></code> argument must be two-dimensional, with rows corresponding to subjects and columns corresponding to the time points used in the trapezoidal approximation for the cumulative hazard.</p>
<p><strong>Hazard function.</strong>
When no specific parametric form for the hazard function is assumed, <code class="docutils literal notranslate"><span class="pre">TorchSurv</span></code> allows the model to learn the hazard function <span class="math notranslate nohighlight">\(\lambda_i(t)\)</span> directly from a neural network.
In this framework, the network takes the covariates <span class="math notranslate nohighlight">\(\mathbf{x}_i\)</span> (and optionally time <span class="math notranslate nohighlight">\(t\)</span>) as input and outputs an estimate of the instantaneous log hazard rate <span class="math notranslate nohighlight">\(h_i(t)\)</span>.</p>
<div class="math notranslate nohighlight">
\[
\log h_i(t) = f_{\theta}(\mathbf{x}_i(t), t)
\]</div>
<p><strong>Loss function.</strong>
The loss function is defined as the negative log-likelihood given by:</p>
<div class="math notranslate nohighlight">
\[
\text{nll} = - \sum_{i=1}^N \delta_i \log h_i(T_i) + \sum_{i=1}^N \int_0^{T_i} h_i(u) \, du,
\]</div>
<p>where the first term corresponds to the observed events and the second term integrates the predicted hazard over time to account for the survival component.</p>
<p>Since the cumulative hazard, defined by the integral <span class="math notranslate nohighlight">\(H(T_i) = \int_0^{T_i} h_i(u)\,du\)</span>, has no closed-form solution when the hazard, <span class="math notranslate nohighlight">\(h_i(t)\)</span>, is modeled by a neural network, it is numerically approximated in <code class="docutils literal notranslate"><span class="pre">TorchSurv</span></code> using the trapezoidal rule over a discretized time grid.
This makes the flexible survival model the only loss function in <code class="docutils literal notranslate"><span class="pre">TorchSurv</span></code> that requires an approximation of the likelihood.</p>
<p>This model is particularly powerful when the true hazard does not follow a standard parametric form, such as Weibull or exponential. Indeed, if the neural network outputs hazards corresponding to these forms, this model will recover their respective log-likelihoods exactly.</p>
<p><strong>Assumptions.</strong></p>
<ul class="simple">
<li><p>The hazard function <span class="math notranslate nohighlight">\(h_i(t)\)</span> is well-approximated by the neural network.</p></li>
<li><p>Censoring is independent of event times.</p></li>
<li><p>Observations are conditionally independent given the covariates.</p></li>
<li><p>Numerical integration (trapezoidal rule) is sufficiently accurate given the time discretization.</p></li>
</ul>
</section>
<section id="faq">
<h2>FAQ<a class="headerlink" href="#faq" title="Link to this heading">#</a></h2>
<section id="what-are-time-varying-covariates">
<h3>What are time-varying covariates?<a class="headerlink" href="#what-are-time-varying-covariates" title="Link to this heading">#</a></h3>
<p>Time-varying covariates are features or measurements of individuals that can change over time. For example, blood pressure, lab test results, or even sensor data may vary at different time points. Survival models can use this information to better estimate risk over time.</p>
</section>
<section id="can-the-cox-model-handle-time-varying-covariates">
<h3>Can the Cox model handle time-varying covariates?<a class="headerlink" href="#can-the-cox-model-handle-time-varying-covariates" title="Link to this heading">#</a></h3>
<p>Yes, the extended Cox model can handle time-varying covariates. However, it assumes that the relative hazard function <span class="math notranslate nohighlight">\(\lambda_i(t)\)</span> does not vary due to time-dependent parameters. In practice, this means the function <span class="math notranslate nohighlight">\(f_\theta\)</span> (or the regression coefficients <span class="math notranslate nohighlight">\(\beta\)</span> in standard Cox) must remain fixed over time.</p>
</section>
<section id="what-type-of-neural-networks-nns-can-be-used-with-the-cox-model-for-time-varying-covariates">
<h3>What type of neural networks (NNs) can be used with the Cox model for time-varying covariates?<a class="headerlink" href="#what-type-of-neural-networks-nns-can-be-used-with-the-cox-model-for-time-varying-covariates" title="Link to this heading">#</a></h3>
<p>In the extended Cox model implemented in <code class="docutils literal notranslate"><span class="pre">TorchSurv</span></code>, only neural networks that produce a fixed mapping from covariates to relative hazard can be used. This means that the network function <span class="math notranslate nohighlight">\(f_\theta\)</span> must be independent of time. Essentially, each time-varying covariate vector <span class="math notranslate nohighlight">\(\mathbf{x}_i(t)\)</span> is treated independently at its observed time points, and the same network parameters are applied across all times.</p>
</section>
<section id="what-is-the-difference-between-the-cox-model-and-the-flexible-survival-model">
<h3>What is the difference between the Cox model and the flexible survival model?<a class="headerlink" href="#what-is-the-difference-between-the-cox-model-and-the-flexible-survival-model" title="Link to this heading">#</a></h3>
<p>The Cox model assumes proportional hazards and a neural network mapping covariates to relative hazard. The flexible survival model makes no assumptions about the hazard function form and allows a neural network to directly model the instantaneous hazard <span class="math notranslate nohighlight">\(h_i(t)\)</span> as a function of covariates and optionally time. This model requires numerical integration for the likelihood.</p>
</section>
<section id="when-should-i-use-the-flexible-survival-model-instead-of-the-cox-model">
<h3>When should I use the flexible survival model instead of the Cox model?<a class="headerlink" href="#when-should-i-use-the-flexible-survival-model-instead-of-the-cox-model" title="Link to this heading">#</a></h3>
<p>The flexible survival model is recommended when the relationship between covariates and the hazard is complex or time-dependent, and you want to model it with a neural network. Unlike the Cox model, it does not assume proportional hazards and allows the hazard function to vary flexibly over time.</p>
</section>
<section id="can-i-use-time-varying-covariates-with-weibull-or-exponential-model">
<h3>Can I use time-varying covariates with Weibull or Exponential model?<a class="headerlink" href="#can-i-use-time-varying-covariates-with-weibull-or-exponential-model" title="Link to this heading">#</a></h3>
<p>No. Parametric models like Weibull or Exponential assume a specific functional form for the hazard over time. Their hazard functions are already fully determined by the model parameters, so they cannot directly incorporate additional time-varying covariates.</p>
</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="metrics.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Metrics</p>
      </div>
    </a>
    <a class="right-next"
       href="../CHANGELOG.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Changelog</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extended-cox-model">1. Extended Cox Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#flexible-survival-model">2. Flexible Survival Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#faq">FAQ</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-are-time-varying-covariates">What are time-varying covariates?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#can-the-cox-model-handle-time-varying-covariates">Can the Cox model handle time-varying covariates?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-type-of-neural-networks-nns-can-be-used-with-the-cox-model-for-time-varying-covariates">What type of neural networks (NNs) can be used with the Cox model for time-varying covariates?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-the-difference-between-the-cox-model-and-the-flexible-survival-model">What is the difference between the Cox model and the flexible survival model?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#when-should-i-use-the-flexible-survival-model-instead-of-the-cox-model">When should I use the flexible survival model instead of the Cox model?</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#can-i-use-time-varying-covariates-with-weibull-or-exponential-model">Can I use time-varying covariates with Weibull or Exponential model?</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Thibaud Coroller, MÃ©lodie Monod, Peter Krusche, Qian Cao
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2024, Novartis Pharma AG.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>